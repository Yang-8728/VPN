# Outline VPN 快速部署指南

## 第一步：购买华为云服务器

1. 登录华为云控制台
2. 选择 **中国区域**（北京/上海/广州都可以）
3. 购买 **弹性云服务器 ECS**
   - 规格：1核1G（最小配置即可）
   - 镜像：Ubuntu 20.04 或 22.04
   - 带宽：1Mbps 即可
   - 计费：按需计费（用完就删，省钱）
4. 配置安全组，开放端口：
   - 入方向规则：允许所有 TCP 和 UDP 端口（或至少开放 443、80、以及随机高位端口）

## 第二步：连接服务器

```bash
# 使用 SSH 连接到服务器
ssh root@你的服务器IP
```

## 第三步：运行部署脚本

```bash
# 下载脚本（如果你把脚本上传到服务器）
# 或者直接复制 deploy-outline.sh 的内容到服务器

# 给脚本执行权限
chmod +x deploy-outline.sh

# 运行脚本
sudo bash deploy-outline.sh
```

## 第四步：保存连接信息

脚本运行完成后，会显示类似这样的信息：

```
CONGRATULATIONS! Your Outline server is up and running.

To manage your Outline server, please copy the following line (including curly brackets) into Step 2 of the Outline Manager interface:

{"apiUrl":"https://xxx.xxx.xxx.xxx:xxxxx/xxxxxx","certSha256":"xxxxxx"}
```

**重要：保存这段信息！**

同时还会显示一个 `ss://` 开头的连接字符串，这个是给客户端用的。

## 第五步：iPhone 连接

1. 在 App Store 搜索 **Outline** 并下载（完全免费）
2. 打开 Outline App
3. 点击 **+** 添加服务器
4. 粘贴 `ss://` 开头的连接字符串
5. 点击连接

## 第六步：测试

1. 连接成功后，打开浏览器访问 https://ip.sb
2. 应该显示中国的 IP 地址
3. 打开你的中国 App，接收验证码

## 第七步：用完清理

```bash
# 停止 Outline 服务
docker stop $(docker ps -q --filter ancestor=quay.io/outline/shadowbox)

# 删除容器
docker rm $(docker ps -aq --filter ancestor=quay.io/outline/shadowbox)
```

然后在华为云控制台删除服务器，停止计费。

## 故障排查

### 无法连接服务器

1. 检查华为云安全组是否开放了所有端口
2. 检查服务器防火墙：`ufw status`（如果启用了，需要开放端口）
3. 确认服务器 IP 地址正确

### 连接成功但无法访问

1. 检查 Outline 服务是否运行：`docker ps`
2. 查看日志：`docker logs $(docker ps -q --filter ancestor=quay.io/outline/shadowbox)`

### 验证码收不到

确保：
1. VPN 已连接
2. 手机没有使用其他代理
3. App 的网络权限已开启

## 成本估算

- 服务器：1核1G，按需计费，约 0.1-0.2 元/小时
- 使用 1 小时：约 0.1-0.2 元
- Outline 客户端：完全免费

总成本：几毛钱
